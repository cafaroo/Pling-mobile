# √ÖTG√ÑRDSPLAN F√ñR TEAM-FUNKTIONALITETEN

## √ñVERSIKT

Denna √•tg√§rdsplan baseras p√• kodgranskningen i `teams_audit.txt` och inneh√•ller konkreta uppgifter f√∂r att f√∂rb√§ttra team-funktionaliteten i Pling-appen. Uppgifterna √§r organiserade efter prioritet och uppskattad tids√•tg√•ng.

## STATUSUPPDATERING (2024-04-30)

### Slutf√∂rda uppgifter:
- ‚úÖ Databasprestanda med index (P1-06, P1-07, P1-08)
- ‚úÖ Till√§gg av nya kolumner i team_messages (P4-01, P4-02, P4-03)
- ‚úÖ Implementation av JSON-schema validering f√∂r team settings
- ‚úÖ Standardiserad felhantering i teamService (P1-09, P1-10, P1-11, P1-12, P1-13, P1-14)
  - Implementerat TeamServiceResponse typ
  - Skapat handleServiceError hj√§lpfunktion
  - Uppdaterat alla teamService funktioner med ny felhantering
- ‚úÖ Korrigering av propnamnsfel i komponenter (P1-01 till P1-05)
  - PendingApprovalCard: icon ‚Üí Icon
  - PendingMembershipCard: icon ‚Üí Icon
  - PendingInviteCard: icon ‚Üí Icon
  - TeamList: Ingen √•tg√§rd kr√§vdes (anv√§nder inte Button)
  - √ñvriga komponenter: title ‚Üí children i TeamSettings, InviteCodeModal och AddMemberModal
- ‚úÖ Uppdatering av queries f√∂r nya kolumner (P4-04)
  - Uppdaterat databasstruktur med mentions (jsonb), attachments (text[]) och message_type (text)
  - Uppdaterat SELECT, INSERT och realtime subscriptions i chat.tsx
  - Lagt till st√∂d f√∂r olika meddelandetyper (text, image, file)
  - Implementerat visning av mentions och attachments i chattgr√§nssnittet
- ‚úÖ Uppdelning av team/index.tsx i mindre komponenter (P2-01 till P2-06)
  - Skapat TeamHeader f√∂r navigering och teamval
  - Skapat TeamActions f√∂r teamrelaterade √•tg√§rder
  - Skapat TeamMembers f√∂r medlemshantering och inst√§llningar
  - Skapat TeamLoadingState f√∂r laddningstillst√•nd
  - Refaktoriserat team/index.tsx att anv√§nda nya komponenter
  - √ñverf√∂rt state och logik till respektive komponent
- ‚úÖ Implementera React Query konsekvent (P2-07 till P2-10)
  - Skapat useTeamQueries hook f√∂r att hantera alla team-relaterade queries
  - Implementerat React Query i TeamScreen
  - Skapat f√∂rb√§ttrad hantering av laddningstillst√•nd med React Query
  - Implementerat felhantering med React Query
  - Skapat optimistiska uppdateringar f√∂r b√§ttre anv√§ndarupplevelse
- ‚úÖ F√∂rb√§ttra typhantering (P2-11 till P2-14)
  - Refaktoriserat 'any'-typer i teamService
  - Skapat centrala typ-exporter
  - F√∂rb√§ttrat typning i TeamMemberList-komponenten
  - Implementerat diskriminerande union-typer f√∂r tillst√•nd
- ‚úÖ F√∂rb√§ttra kods√∂kning i TeamMemberList (P3-01 till P3-02)
  - Skapat gemensam MemberItem-komponent f√∂r att hantera medlemsvisning
  - Refaktoriserat TeamMemberList, PendingApprovalCard, PendingMembershipCard, PendingInviteCard

### N√§sta steg:
1. Forts√§tt konsolidera duplicerad kod i TeamMemberList (P3-03 till P3-04):
   - Ta bort dubblerad kod i TeamMemberList
   - F√∂rb√§ttra typning med diskriminerande unions

---

## PRIORITET 1: AKUTA PROBLEM (1-2 ARBETSDAGAR)

### 1.1 Korrigera propnamnsfel `icon` till `Icon` i komponenter

| Task ID | Beskrivning | Uppskattad tid | Status | Ber√∂rda filer |
|---------|-------------|----------------|--------|---------------|
| P1-01 | Korrigera `icon` till `Icon` i PendingApprovalCard | 15 min | ‚úÖ Klar | components/team/PendingApprovalCard.tsx |
| P1-02 | Korrigera `icon` till `Icon` i PendingMembershipCard | 15 min | ‚úÖ Klar | components/team/PendingMembershipCard.tsx |
| P1-03 | Korrigera `icon` till `Icon` i PendingInviteCard | 15 min | ‚úÖ Klar | components/team/PendingInviteCard.tsx |
| P1-04 | Korrigera `icon` till `Icon` i TeamList | 15 min | ‚úÖ Klar (N/A) | components/team/TeamList.tsx |
| P1-05 | Korrigera andra komponenter som anv√§nder Button | 30 min | ‚úÖ Klar | √ñvriga filer |

### 1.2 Databasprestanda med index

| Task ID | Beskrivning | Uppskattad tid | Status | Ber√∂rda filer |
|---------|-------------|----------------|--------|---------------|
| P1-06 | Skapa index f√∂r `user_id` i `team_members` | 20 min | ‚úÖ Klar | DB-migrering |
| P1-07 | Skapa index f√∂r `team_id` i `team_members` | 20 min | ‚úÖ Klar | DB-migrering |
| P1-08 | Skapa index f√∂r `team_id` i `team_messages` | 20 min | ‚úÖ Klar | DB-migrering |

### 1.3 Standardisera felhantering i teamService

| Task ID | Beskrivning | Uppskattad tid | Status | Ber√∂rda filer |
|---------|-------------|----------------|--------|---------------|
| P1-09 | Skapa hj√§lpfunktion f√∂r felhantering | 30 min | ‚úÖ Klar | services/teamService.ts |
| P1-10 | Implementera standardiserad felhantering i `createTeam` | 15 min | ‚úÖ Klar | services/teamService.ts |
| P1-11 | Implementera standardiserad felhantering i `getTeam` | 15 min | ‚úÖ Klar | services/teamService.ts |
| P1-12 | Implementera standardiserad felhantering i `updateTeam` | 15 min | ‚úÖ Klar | services/teamService.ts |
| P1-13 | Implementera standardiserad felhantering i `getUserTeams` | 15 min | ‚úÖ Klar | services/teamService.ts |
| P1-14 | Implementera standardiserad felhantering i √∂vriga funktioner | 1 timme | ‚úÖ Klar | services/teamService.ts |

**Totalt: ~1.5 timmar**

---

## PRIORITET 2: VIKTIGA F√ñRB√ÑTTRINGAR (3-5 ARBETSDAGAR)

### 2.1 Dela upp team/index.tsx i mindre komponenter

| Task ID | Beskrivning | Uppskattad tid | Status | Ber√∂rda filer |
|---------|-------------|----------------|--------|---------------|
| P2-01 | Skapa TeamHeader-komponent | 2 timmar | ‚úÖ Klar | app/(tabs)/team/components/TeamHeader.tsx |
| P2-02 | Skapa TeamActions-komponent | 2 timmar | ‚úÖ Klar | app/(tabs)/team/components/TeamActions.tsx |
| P2-03 | Skapa TeamMembers-komponent | 3 timmar | ‚úÖ Klar | app/(tabs)/team/components/TeamMembers.tsx |
| P2-04 | Skapa TeamSettings-container | 2 timmar | ‚úÖ Klar | app/(tabs)/team/components/TeamSettingsContainer.tsx |
| P2-05 | Refaktorisera team/index.tsx att anv√§nda nya komponenter | 3 timmar | ‚úÖ Klar | app/(tabs)/team/index.tsx |
| P2-06 | √ñverf√∂ra state och logik till respektive komponent | 3 timmar | ‚úÖ Klar | Alla komponenterna |

**Totalt: ~15 timmar**

### 2.2 Implementera React Query konsekvent

| Task ID | Beskrivning | Uppskattad tid | Status | Ber√∂rda filer |
|---------|-------------|----------------|--------|---------------|
| P2-07 | Skapa queries f√∂r teams-data | 2 timmar | ‚úÖ Klar | hooks/useTeamQueries.ts |
| P2-08 | Implementera teamQueries i team/index.tsx | 2 timmar | ‚úÖ Klar | app/(tabs)/team/TeamScreen.tsx |
| P2-09 | Hantera laddningstillst√•nd med React Query | 1 timme | ‚úÖ Klar | components/team/TeamLoadingState.tsx |
| P2-10 | Implementera felhantering med React Query | 1 timme | ‚úÖ Klar | app/(tabs)/team/TeamScreen.tsx |

**Totalt: ~6 timmar**

### 2.3 F√∂rb√§ttra typhantering

| Task ID | Beskrivning | Uppskattad tid | Status | Ber√∂rda filer |
|---------|-------------|----------------|--------|---------------|
| P2-11 | Refaktorisera 'any'-typer i teamService | 2 timmar | ‚úÖ Klar | services/teamService.ts |
| P2-12 | Skapa centrala typ-exporter | 1 timme | ‚úÖ Klar | types/service.ts, types/team.ts |
| P2-13 | F√∂rb√§ttra typning i TeamMemberList-komponenten | 1 timme | ‚úÖ Klar | components/team/TeamMemberList.tsx |
| P2-14 | Implementera diskriminerande union-typer f√∂r tillst√•nd | 2 timmar | ‚úÖ Klar | hooks/useTeamState.ts |

**Totalt: ~6 timmar**

### 2.4 Komplettera bilduppladdning i TeamSettings

| Task ID | Beskrivning | Uppskattad tid | Status | Ber√∂rda filer |
|---------|-------------|----------------|--------|---------------|
| P2-15 | Implementera komplett filuppladdning till Supabase | 2 timmar | ‚úÖ Klar | components/team/TeamSettings.tsx |
| P2-16 | L√§gg till felhantering f√∂r bilduppladdning | 1 timme | ‚úÖ Klar | components/team/TeamSettings.tsx |
| P2-17 | L√§gg till laddningsindikator f√∂r bilduppladdning | 30 min | ‚úÖ Klar | components/team/TeamSettings.tsx |

**Totalt: ~3.5 timmar**

---

## PRIORITET 3: OMFATTANDE F√ñRB√ÑTTRINGAR (1-2 VECKOR)

### 3.1 Konsolidera duplicerad kod i TeamMemberList

| Task ID | Beskrivning | Uppskattad tid | Status | Ber√∂rda filer |
|---------|-------------|----------------|--------|---------------|
| P3-01 | Skapa gemensam MemberItem-komponent | 5 timmar | ‚úÖ Klar | components/team/MemberItem.tsx |
| P3-02 | Refaktorisera TeamMemberList att anv√§nda MemberItem | 6 timmar | ‚úÖ Klar | components/team/TeamMemberList.tsx, components/team/TeamMemberListItem.tsx, components/team/PendingApprovalCard.tsx, components/team/PendingMembershipCard.tsx, components/team/PendingInviteCard.tsx |
| P3-03 | Ta bort dubblerad kod i TeamMemberList | 4 timmar | ‚úÖ Klar | components/team/TeamMemberList.tsx, components/team/TeamMemberListItem.tsx |
| P3-04 | F√∂rb√§ttra typning med diskriminerande unions | 3 timmar | ‚úÖ Klar | components/team/TeamMemberList.tsx |

**Totalt: ~18 timmar**

### 3.2 Implementera useReducer f√∂r komplex state

| Task ID | Beskrivning | Uppskattad tid | Ber√∂rda filer |
|---------|-------------|----------------|---------------|
| P3-05 | Skapa TeamState-typer och actions | 2 timmar | ‚úÖ Klar | hooks/useTeamState.ts |
| P3-06 | Implementera teamReducer f√∂r komplex state | 4 timmar | ‚úÖ Klar | hooks/useTeamState.ts |
| P3-07 | Erbjuda useTeamState-hook f√∂r komponenter | 2 timmar | ‚úÖ Klar | hooks/useTeamState.ts |
| P3-08 | Migrera team/index.tsx till att anv√§nda useTeamState | 4 timmar | ‚úÖ Klar | app/(tabs)/team/index.tsx |

**Totalt: ~12 timmar**

### 3.3 Skapa dedikerad hook f√∂r team-mutationer

| Task ID | Beskrivning | Uppskattad tid | Ber√∂rda filer |
|---------|-------------|----------------|---------------|
| P3-09 | Skapa useTeamMutations-hook | 3 timmar | ‚úÖ Klar | hooks/useTeamMutations.ts |
| P3-10 | Implementera optimistiska uppdateringar | 3 timmar | ‚úÖ Klar | hooks/useTeamMutations.ts |
| P3-11 | Migrera komponenter till att anv√§nda useTeamMutations | 4 timmar | ‚úÖ Klar | Olika components/team/*.tsx |

**Totalt: ~10 timmar**

### 3.4 F√∂rb√§ttra prestanda

| Task ID | Beskrivning | Uppskattad tid | Ber√∂rda filer |
|---------|-------------|----------------|---------------|
| P3-12 | Implementera React.memo f√∂r TeamMemberListItem | 2 timmar | ‚úÖ Klar | components/team/MemberItem.tsx |
| P3-13 | Implementera virtualisering f√∂r stora listor | 2 timmar | ‚úÖ Klar | components/team/TeamMemberList.tsx |
| P3-14 | Optimera React Query-cachning | 2 timmar | ‚úÖ Klar | hooks/useTeamQueries.ts |
| P3-15 | Implementera optimerad FlatList | 1 timme | ‚úÖ Klar | components/team/TeamMemberList.tsx, components/team/TeamMembers.tsx |

**Totalt: ~6 timmar**

---

## PRIORITET 4: L√ÖNGSIKTIGA F√ñRB√ÑTTRINGAR (P√ÖG√ÖENDE ARBETE)

### 4.1 Ut√∂ka databasstrukturen

| Task ID | Beskrivning | Uppskattad tid | Status | Ber√∂rda filer |
|---------|-------------|----------------|--------|---------------|
| P4-01 | L√§gg till mentions-kolumn i team_messages | 2 timmar | ‚úÖ Klar | DB-migrering |
| P4-02 | L√§gg till attachments-kolumn i team_messages | 2 timmar | ‚úÖ Klar | DB-migrering |
| P4-03 | L√§gg till message_type-kolumn i team_messages | 1 timme | ‚úÖ Klar | DB-migrering |
| P4-04 | Uppdatera befintliga queries att hantera nya kolumner | 3 timmar | ‚úÖ Slutf√∂rd | services/teamService.ts |

**Totalt: ~8 timmar** (100% slutf√∂rt)

### 4.2 Skriv end-to-end tester

| Task ID | Beskrivning | Uppskattad tid | Ber√∂rda filer |
|---------|-------------|----------------|---------------|
| P4-05 | Skapa testmilj√∂ f√∂r team-komponenter | 4 timmar | tests/setup.ts |
| P4-06 | Skriv tester f√∂r TeamMemberList | 3 timmar | tests/components/TeamMemberList.test.tsx |
| P4-07 | Skriv tester f√∂r TeamSettings | 3 timmar | tests/components/TeamSettings.test.tsx |
| P4-08 | Skriv tester f√∂r PendingApprovalCard | 2 timmar | tests/components/PendingApprovalCard.test.tsx |
| P4-09 | Skriv integrationstester f√∂r TeamScreen | 4 timmar | tests/screens/TeamScreen.test.tsx |

**Totalt: ~16 timmar**

### 4.3 F√∂rb√§ttra dokumentation

| Task ID | Beskrivning | Uppskattad tid | Status | Ber√∂rda filer |
|---------|-------------|----------------|--------|---------------|
| P4-10 | L√§gg till JSDoc f√∂r alla team-komponenter | 4 timmar | üîÑ I Arbete (40%) | components/team/*.tsx |
| P4-11 | L√§gg till JSDoc f√∂r teamService | 3 timmar | ‚úÖ Klar | services/teamService.ts |
| P4-12 | Skapa README f√∂r team-modulen | 2 timmar | ‚úÖ Klar | docs/README.md |
| P4-13 | Dokumentera datafl√∂den och datamodeller | 2 timmar | ‚úÖ Klar | docs/team-data-flow.md |
| P4-14 | Skapa fullst√§ndig modulbeskrivning | 3 timmar | ‚úÖ Klar | docs/team-module.md |
| P4-15 | Skapa implementationsguide f√∂r team | 3 timmar | ‚úÖ Klar | docs/team-implementation-guide.md |
| P4-16 | Skapa testguide f√∂r team-modulen | 2 timmar | ‚úÖ Klar | docs/team-testing-guide.md |
| P4-17 | Skapa UX och grafisk frontend-plan | 3 timmar | ‚úÖ Klar | docs/team_frontend.txt |

**Total tidsuppskattning f√∂r dokumentation: ~22 timmar** (82% slutf√∂rt)

### 4.4 Standardisera namngivning

| Task ID | Beskrivning | Uppskattad tid | Ber√∂rda filer |
|---------|-------------|----------------|---------------|
| P4-14 | Standardisera namngivning i komponenter till svenska | 3 timmar | components/team/*.tsx |
| P4-15 | Standardisera namngivning i services till svenska | 2 timmar | services/teamService.ts |
| P4-16 | Standardisera namngivning i typer till svenska | 2 timmar | types/team.ts |

**Totalt: ~7 timmar**

## PRIORITET 5: UX/UI F√ñRB√ÑTTRINGAR (PARALLELL UTVECKLING)

### 5.1 Design och specifikation

| Task ID | Beskrivning | Uppskattad tid | Status | Ber√∂rda filer |
|---------|-------------|----------------|--------|---------------|
| P5-01 | Skapa UX-komponentbibliotek f√∂r team | 8 timmar | P√•b√∂rjad | design/components/team/* |
| P5-02 | Implementera responsiv design f√∂r teamsk√§rmar | 6 timmar | Planerad | components/team/* |
| P5-03 | F√∂rb√§ttra tillg√§nglighet f√∂r team-komponenter | 4 timmar | Planerad | components/team/* |
| P5-04 | Optimera animationer och √∂verg√•ngseffekter | 3 timmar | Planerad | components/team/animations.ts |

### 5.2 UI-implementation

| Task ID | Beskrivning | Uppskattad tid | Status | Ber√∂rda filer |
|---------|-------------|----------------|--------|---------------|
| P5-05 | Implementera TeamCard enligt UX-spec | 4 timmar | ‚úÖ Klar | components/team/TeamCard.tsx |
| P5-06 | Implementera MemberItem enligt UX-spec | 3 timmar | Planerad | components/team/MemberItem.tsx |
| P5-07 | Implementera RoleBadge och StatusBadge | 2 timmar | ‚úÖ Klar | components/team/badges/*, components/team/RoleBadge.tsx, components/team/StatusBadge.tsx |
| P5-08 | Implementera TeamAvatar med fallbacks | 2 timmar | ‚úÖ Klar | components/team/TeamAvatar.tsx |
| P5-09 | Implementera AvatarUploader med besk√§rning | 6 timmar | ‚úÖ Klar | components/ui/AvatarUploader.tsx |
| P5-10 | Implementera InvitationCard design | 3 timmar | ‚úÖ Klar | components/team/InvitationCard.tsx |
| P5-11 | F√∂rb√§ttra laddningstillst√•nd f√∂r teamvyer | 2 timmar | ‚úÖ Klar | components/team/TeamScreen.tsx, components/team/TeamList.tsx |

### 5.3 Anv√§ndarupplevelse

| Task ID | Beskrivning | Uppskattad tid | Status | Ber√∂rda filer |
|---------|-------------|----------------|--------|---------------|
| P5-11 | F√∂rb√§ttra feedback-mekanismer och felmeddelanden | 4 timmar | ‚úÖ Klar | components/team/TeamSettings.tsx |
| P5-12 | Implementera offline-st√∂d och synkronisering | 8 timmar | Planerad | hooks/useTeamSync.ts |
| P5-13 | Optimera laddningstider och skelettvyer | 3 timmar | ‚úÖ Klar | components/team/TeamSettings.tsx |
| P5-14 | Implementera A/B-tester f√∂r inbjudningsfl√∂den | 6 timmar | Planerad | app/(tabs)/team/experiments/* |
| P5-15 | Genomf√∂ra anv√§ndartester och √•tg√§rda feedback | 8 timmar | Planerad | docs/user-testing/* |

**Total tidsuppskattning f√∂r UX/UI f√∂rb√§ttringar: ~70 timmar** (20% slutf√∂rt)

## SAMMANFATTNING

### Total tidsuppskattning per prioritet

| Prioritet | Beskrivning | Uppskattad tid | Slutf√∂rt |
|-----------|-------------|----------------|----------|
| 1 | Akuta problem | ~5 timmar | 100% |
| 2 | Viktiga f√∂rb√§ttringar | ~30.5 timmar | 100% |
| 3 | Omfattande f√∂rb√§ttringar | ~46 timmar | 100% |
| 4 | L√•ngsiktiga f√∂rb√§ttringar | ~45 timmar | ~25% |
| 5 | UX/UI f√∂rb√§ttringar | ~70 timmar | ~20% |

**Total tidsuppskattning √•terst√•ende: ~90 timmar (ca 11-14 arbetsdagar)**

### Uppdaterad √•tg√§rdsplan

1. Forts√§tt med dokumentation och testning:
   - Slutf√∂r JSDoc-kommentarer f√∂r kod (P4-10, P4-11)
   - Implementera enhetstester f√∂r kritiska komponenter

2. P√•b√∂rja UX/UI f√∂rb√§ttringar parallellt:
   - ‚úÖ Implementerat f√∂rb√§ttrad felhantering och laddningsindikation (P5-11, P5-13)
   - ‚úÖ Implementerat TeamAvatar med fallbacks och redigeringsl√§ge (P5-08)
   - ‚úÖ Implementerat RoleBadge och StatusBadge med st√∂d f√∂r olika typer (P5-07)
   - Prioritera implementering av √•terst√•ende grundkomponenter (P5-05, P5-06, P5-09, P5-10)
   - Starta optimeringar av anv√§ndbarhet och tillg√§nglighet

3. L√•ngsiktig planering:
   - Schemal√§gg anv√§ndartester n√§r grundl√§ggande UI-f√∂rb√§ttringar √§r implementerade
   - Integrera UX-arbetet med √∂vriga teamfunktionalitetsf√∂rb√§ttringar

Genom att arbeta parallellt med backend- och UX/UI-f√∂rb√§ttringar kan vi leverera en komplett och f√∂rb√§ttrad teamfunktionalitet som b√•de √§r tekniskt robust och anv√§ndarv√§nlig. 